(this["webpackJsonpsd-0x-project-frontend-online-store"]=this["webpackJsonpsd-0x-project-frontend-online-store"]||[]).push([[0],{31:function(t,e,a){t.exports=a(47)},36:function(t,e,a){},37:function(t,e,a){},47:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),c=a(29),o=a.n(c),l=(a(36),a(37),a(4)),i=a(1),s=a(12),d=a(17),u=a(8),m=a(9),p=a(3),h=a(11),g=a(10),b=function(t){Object(h.a)(a,t);var e=Object(g.a)(a);function a(t){var n;Object(u.a)(this,a);var r=(n=e.call(this,t)).props.location.state.product.addToCart;return n.state={productState:[],addToCart:r},n.add=n.add.bind(Object(p.a)(n)),n.subtract=n.subtract.bind(Object(p.a)(n)),n.handleLocalStorage=n.handleLocalStorage.bind(Object(p.a)(n)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.handleLocalStorage()}},{key:"handleLocalStorage",value:function(){var t,e=localStorage.getItem("cart"),a=JSON.parse(e);a&&(t=Object(d.a)(a).slice(0),this.setState({productState:t,addToCart:t}))}},{key:"add",value:function(t){var e=this.state.productState,a="".concat(t.target.name),n=e.find((function(t){return t.id===a}));e.push(n);var r=JSON.stringify(e);localStorage.removeItem("cart"),localStorage.setItem("cart",r);var c=localStorage.getItem("cart"),o=JSON.parse(c);this.setState({productState:o,addToCart:o})}},{key:"subtract",value:function(t){var e=this.state.productState,a="".concat(t.target.name),n=e.find((function(t){return t.id===a})),r=e.indexOf(n);e.splice(r,1);var c=JSON.stringify(e);localStorage.removeItem("cart"),localStorage.setItem("cart",c);var o=localStorage.getItem("cart"),l=JSON.parse(o);console.log(l),this.setState({productState:l,addToCart:l})}},{key:"countRepeatedElements",value:function(t,e){return t.filter((function(t){return t.id===e.id})).length}},{key:"render",value:function(){var t=this,e=this.state.addToCart,a=e.map((function(t){return t.id})),n=Object(s.a)(new Set(a)).reduce((function(t,a){var n=e.find((function(t){return t.id===a}));return t.push(n),t}),[]);return n.sort(),console.clear(),console.log("ShoppingCart addToCart",e),r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement(l.b,{to:{pathname:"/",state:{product:e}},className:"link-voltar"},"voltar"),r.a.createElement(l.b,{to:{pathname:"/checkout",state:{products:{noRepetElementsAddToCart:n},products2:{addToCart:e}}},"data-testid":"checkout-products",className:"link-buy"},"Comprar")),n&&n.length>0?n.map((function(a){return r.a.createElement("div",{"data-testid":"shopping-cart-product-quantity",key:a.id,className:"card-product-cart"},r.a.createElement("p",{"data-testid":"shopping-cart-product-name",className:"cart-title"},a.title),r.a.createElement("img",{src:a.thumbnail,alt:"foto",width:"100px"}),r.a.createElement("p",null,"R$ ".concat(a.price)),a.shipping.free_shipping?r.a.createElement("p",{"data-testid":"free-shipping",className:"shi"},"\xb0Frete Gr\xe1tis"):null,r.a.createElement("div",{className:"buttons-add-remove-container"},r.a.createElement("button",{"data-testid":"product-increase-quantity",type:"button",name:a.id,onClick:t.add,className:"button-more-less"},"+"),r.a.createElement("p",null,t.countRepeatedElements(e,a)),r.a.createElement("button",{"data-testid":"product-decrease-quantity",type:"button",name:a.id,onClick:t.subtract,className:"button-more-less"},"-")))})):r.a.createElement("p",{"data-testid":"shopping-cart-empty-message"},"Seu carrinho est\xe1 vazio"))}}]),a}(r.a.Component),f=a(23),v=a(22),E=a(18),k=a.n(E),C=a(27),y="https://api.mercadolibre.com/sites/MLB";function S(){return(S=Object(C.a)(k.a.mark((function t(){var e;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(y,"/categories")).then((function(t){return t.json()})).catch((function(t){return console.log(t)}));case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,e){return N.apply(this,arguments)}function N(){return(N=Object(C.a)(k.a.mark((function t(e,a){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(y,"/search?category=").concat(e,"&q=").concat(a)).then((function(t){return t.json()})).catch((function(t){return console.log(t)}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var j=function(t){Object(h.a)(a,t);var e=Object(g.a)(a);function a(t){var n;return Object(u.a)(this,a),(n=e.call(this,t)).state={categories:[],inputValue:"",listProducts:{},selectCategory:"",addToCart:[]},n.listOfCategories=n.listOfCategories.bind(Object(p.a)(n)),n.getQuery=n.getQuery.bind(Object(p.a)(n)),n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleCategory=n.handleCategory.bind(Object(p.a)(n)),n.handleClick=n.handleClick.bind(Object(p.a)(n)),n.bob=n.handleLocalStorage.bind(Object(p.a)(n)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var t=this;(function(){return S.apply(this,arguments)})().then((function(e){return t.setState({categories:e})})),this.handleLocalStorage()}},{key:"handleClick",value:function(t){var e=this.state,a=e.listProducts,n=e.addToCart,r=t.target.id,c=a.filter((function(t){return t.id===r})),o=Object(f.a)(c,1)[0];this.setState({addToCart:[].concat(Object(s.a)(n),[o])});var l=[].concat(Object(s.a)(n),[o]),i=JSON.stringify(l);localStorage.setItem("cart",i)}},{key:"handleChange",value:function(t){var e=t.target.value;this.setState({inputValue:e})}},{key:"handleCategory",value:function(t){var e=this,a=this.state,n=a.inputValue,r=a.categories,c=t.target.value,o=r.filter((function(t){return t.name===c}))[0].id;O(o,n).then((function(t){e.setState({listProducts:t.results})})),this.setState({selectCategory:o})}},{key:"handleLocalStorage",value:function(){var t,e=localStorage.getItem("cart"),a=JSON.parse(e);a&&(t=Object(d.a)(a).slice(0),this.setState({addToCart:t}))}},{key:"getQuery",value:function(){var t=this,e=this.state,a=e.inputValue;O(e.selectCategory,a).then((function(e){return t.setState({listProducts:e.results})}))}},{key:"listOfCategories",value:function(t){var e=this;return t?t.map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("input",{"data-testid":"category",className:"categories",name:"1",type:"radio",value:t.name,onChange:e.handleCategory}),r.a.createElement("span",null,t.name))})):null}},{key:"render",value:function(){var t,e=this,a=this.state,n=a.categories,c=a.listProducts,o=a.addToCart,i=localStorage.getItem("cart"),s=JSON.parse(i);s?t=Object(d.a)(s).slice(0):t=[];return console.clear(),console.log("SearchBar addToCart",o),r.a.createElement("section",null,r.a.createElement("header",null,r.a.createElement("label",{htmlFor:"search-input","data-testid":"home-initial-message"},"Digite algum termo de pesquisa ou escolha uma categoria.",r.a.createElement("input",{type:"text",className:"search-input","data-testid":"query-input",onChange:this.handleChange}),r.a.createElement("button",{type:"button",className:"search-button","data-testid":"query-button",onClick:this.getQuery},"Pesquisar")),r.a.createElement(l.b,{to:{pathname:"/shopping-cart",state:{product:{addToCart:o}}},className:"link-cart","data-testid":"shopping-cart-button"},r.a.createElement("div",{"data-testid":"shopping-cart-size"},r.a.createElement(v.a,{className:"link-cart"}),t.length))),r.a.createElement("section",{className:"container"},r.a.createElement("div",{className:"categories-list"},this.listOfCategories(n)),r.a.createElement("div",{className:"products-list"},c.length>0?c.map((function(t){return r.a.createElement("div",{key:t.id,className:"card-product","data-testid":"product"},r.a.createElement("p",null,t.title),r.a.createElement("img",{src:t.thumbnail,alt:"foto",width:"100px",className:"image-search"}),r.a.createElement("p",null,"R$ ".concat(t.price)),t.shipping.free_shipping?r.a.createElement("p",{"data-testid":"free-shipping",className:"shi"},"\xb0Frete Gr\xe1tis "):null,r.a.createElement(l.b,{to:{pathname:"/product-details/".concat(t.id),state:{product:{product:t},addToCart:{addToCart:o},listProducts:{listProducts:c}}},"data-testid":"product-detail-link",className:"link-details"},"Detalhes"),r.a.createElement("button",{id:t.id,type:"button","data-testid":"product-add-to-cart",onClick:e.handleClick,className:"button-addCart"},"Adicionar ao Carrinho"))})):r.a.createElement("p",null,"Nenhum produto foi encontrado"))))}}]),a}(r.a.Component),T=function(t){Object(h.a)(a,t);var e=Object(g.a)(a);function a(t){var n;Object(u.a)(this,a);var r=(n=e.call(this,t)).props.location.state,c=r.listProducts.listProducts,o=r.product.product,l=r.addToCart.addToCart,i=localStorage.getItem("".concat(o.id)),d=JSON.parse(i);return n.state={addToCart:Object(s.a)(l),listProducts:c,rating:d},n.handleClick=n.handleClick.bind(Object(p.a)(n)),n.handleRating=n.handleRating.bind(Object(p.a)(n)),n}return Object(m.a)(a,[{key:"handleClick",value:function(t){var e=this.state,a=e.addToCart,n=e.listProducts,r=t.target.id,c=n.filter((function(t){return t.id===r})),o=Object(f.a)(c,1)[0],l=[].concat(Object(s.a)(a),[o]),i=JSON.stringify(l);localStorage.removeItem("cart"),localStorage.setItem("cart",i);var d=localStorage.getItem("cart"),u=JSON.parse(d);this.setState({addToCart:u})}},{key:"handleRating",value:function(t){var e=this.props.location.state.product.product;localStorage.removeItem("".concat(e.id));var a=JSON.stringify(t.target.value);localStorage.setItem("".concat(e.id),a),this.setState({rating:t.target.value})}},{key:"render",value:function(){var t=this.props.location.state.product.product,e=this.state,a=e.addToCart,n=e.rating;return console.clear(),console.log(a),console.log("Storage do ".concat(t.id),localStorage["".concat(t.id)]),console.log("Storage:",localStorage),r.a.createElement("div",{"data-testid":"product-detail-name"},r.a.createElement("header",null,r.a.createElement(l.b,{to:"/",className:"link-voltar"}," Voltar "),r.a.createElement(l.b,{to:{pathname:"/shopping-cart",state:{product:{addToCart:a}}},className:"link-cart","data-testid":"shopping-cart-button"},r.a.createElement("div",{"data-testid":"shopping-cart-size"},r.a.createElement(v.a,{className:"link-cart"}),a.length))),r.a.createElement("div",{className:"card-product-detail"},r.a.createElement("p",null,t.title),r.a.createElement("img",{className:"image-details",src:t.thumbnail,alt:"foto",width:"160px"}),r.a.createElement("p",null,"R$ ".concat(t.price)),t.shipping.free_shipping?r.a.createElement("p",{"data-testid":"free-shipping"},"\xb0Frete Gr\xe1tis"):null,r.a.createElement("button",{id:t.id,type:"button","data-testid":"product-detail-add-to-cart",onClick:this.handleClick,className:"button-addCart"},"Adicionar ao Carrinho"),r.a.createElement("label",{htmlFor:"textarea",className:"text-area-coment"},"Escreva algum coment\xe1rio :",r.a.createElement("textarea",{name:"textarea",id:"textarea","data-testid":"product-detail-evaluation",cols:"30",rows:"10",value:n,onChange:this.handleRating}))))}}]),a}(r.a.Component),x=function(t){Object(h.a)(a,t);var e=Object(g.a)(a);function a(t){var n;return Object(u.a)(this,a),(n=e.call(this,t)).sumPrices=n.sumPrices.bind(Object(p.a)(n)),n}return Object(m.a)(a,[{key:"sumPrices",value:function(t){return t.reduce((function(t,e){return t+e.price}),0)}},{key:"render",value:function(){var t=this.props.location.state,e=t.products,a=t.products2,n=e.noRepetElementsAddToCart,c=a.addToCart;return console.clear(),console.log("Checkout addToCart",c),r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement(l.b,{to:"/",className:"link-voltar"},"Voltar")),r.a.createElement("div",null,r.a.createElement("h3",null,"Revise seus Produtos:"),n.map((function(t){return r.a.createElement("div",{key:t.id,className:"card-product-cart"},r.a.createElement("img",{src:t.thumbnail,alt:"foto",width:"70px"}),r.a.createElement("p",null,t.title),r.a.createElement("p",null,"R$ ".concat(t.price)))}))),r.a.createElement("p",{className:"total-price"},"R$ ".concat(this.sumPrices(c).toFixed(2))),r.a.createElement("h3",null,"Informa\xe7\xf5es do Comprador:"),r.a.createElement("form",{id:"form-info"},r.a.createElement("label",{htmlFor:"checkout-fullname",className:"labels-checkout"},"Nome completo",r.a.createElement("input",{type:"text","data-testid":"checkout-fullname"})),r.a.createElement("label",{htmlFor:"checkout-email",className:"labels-checkout"},"Email",r.a.createElement("input",{type:"email","data-testid":"checkout-email"})),r.a.createElement("label",{htmlFor:"checkout-cpf",className:"labels-checkout"},"CPF",r.a.createElement("input",{type:"text","data-testid":"checkout-cpf"})),r.a.createElement("label",{htmlFor:"checkout-phone",className:"labels-checkout"},"Telefone",r.a.createElement("input",{type:"text","data-testid":"checkout-phone"})),r.a.createElement("label",{htmlFor:"checkout-cep",className:"labels-checkout"},"CEP",r.a.createElement("input",{type:"text","data-testid":"checkout-cep"})),r.a.createElement("label",{htmlFor:"checkout-address",className:"labels-checkout"},"Endere\xe7o",r.a.createElement("input",{type:"text","data-testid":"checkout-address"})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",className:"button-buy"},"Finalizar"))))}}]),a}(n.Component);var P=function(){return r.a.createElement(l.a,null,r.a.createElement("div",{className:"App",basename:"."},r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/",component:j}),r.a.createElement(i.a,{path:"/shopping-cart",component:b}),r.a.createElement(i.a,{path:"/product-details/:id",component:T}),r.a.createElement(i.a,{path:"/checkout",component:x}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.f53b91bd.chunk.js.map